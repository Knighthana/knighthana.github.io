# 一步状态转移概率矩阵

## 定义一步状态转移概率矩阵

**马尔科夫性质**指的是具有该性质的随机过程在
$t_n$
时刻所处状态为已知时，过程在大于
$t_n$
的时刻所处状态的概率特性只与过程在
$t_n$时刻所处的状态有关，而与过程在$t_n$时刻以前的状态无关，又称此性质为**无后效性**

离散状态空间的马尔科夫过程称为马尔科夫链，由于具有马尔科夫性质的随机过程具有无后效性，所以考虑马尔科夫链上进行状态转移的情况时，只需要考虑此时刻所处的状态，以及将要转移向的状态，而且令人欣喜的是，在任意时刻的这种考虑都是正确的，不必担心时间的影响

那么，不难发现，对于具有马尔科夫性质的随机过程，其在每个状态下向其他任何已知状态转移的概率都是已知的

试图定义马尔科夫链n时刻的k步状态转移概率，n时刻马尔科夫链处于状态i，经过k步，系统处于j状态的概率

这里说“转移了k步”是因为我们在讨论离散时间问题，对于其中每个定义的有意义的时刻，我们说这是“一步”

复习一下概率论中学习过的内容，条件概率等于积事件的概率比上前置事件的概率，
$P(A|B)=P(\frac{AB}{B})$

于是定义k步转移概率为

$p^{(k)}_{ij}(n)=p_{ij}(n,n+k)=p\left\{X(n+k)=j|X(n)=i\right\}$

重复一遍，这个公式中，k代表“k步”，i代表n时刻所处的状态，j是在k步之后要转移到的状态，一个p用括号把它们括起来，代表这件事情发生的概率

由于整个样本空间中所有事件之和发生的概率为1，所以有
$\sum_{j=1}^{\infty }P_{ij}(n,n+k)=1, i=1,2,... $

**但是**，平常用不上k步状态转移概率

最重要、实际中最常用的是一步状态转移概率
$p_{ij}=P_{ij}(1)=P\left\{X_{n+1}=j|X_{n}=i\right\}$
，而且一般来说也只研究一步状态转移概率

如何画出一步状态转移概率矩阵呢？

将n时刻的状态，这是一个样本空间，纵向排布，将n+1时刻的状态，这是另一个样本空间，横向排布，

把i放在铅直方向，排成一竖列，把j放在水平方向，排成一横行

在矩阵中放入每个
$P_{ij}$

$P_{ij}$
即从i状态转移到j状态的概率，例如
$P_{13}$
指从状态1转移到状态3的概率，注意，i和j可以相同

$$
X_{n+1}的状态\\
1\quad 2\quad...\quad j\quad...\\
\begin{bmatrix}
 p_{11} & p_{12} & ... & p_{1j} & ...\\
 p_{21} & p_{22} & ... & p_{2j} & ...\\
 ... & ... & ... & ... & ...\\
 p_{i1} & p_{i2} & ... & p_{ij} & ...\\
 ... & ... & ... & ... & ...
\end{bmatrix}
$$

Latex不支持在矩阵纵向的方括号外面注释，纵向应该要写“
$X_{n}$
的状态”和“1 2 ... i ...”

注意，每一横行的概率之和应当为1，这是验证所画出矩阵是否正确的一个方法

随机过程与排队论课程研究时间齐次马尔科夫过程，简称时齐马尔科夫过程，它满足

$P\{X(t)\le x|X(t_n)=x_n\}=P\{X(t-t_n)\le x|X(0)=x_n\}$

其中假定系统的行为不依赖于观测的时间，即马尔科夫过程中的条件分布函数不随观察起始时刻的变化而变化，我们可以任选时间轴的起点

## 理解这个东西有什么意义

这里引用一下我老师的话，经过二道转述可能不全

状态转移概率矩阵P，是状态转移的桥梁，

令系统从n状态转移到n+1状态，n+2状态，

若

$\lim_{x \to \infty} X_{n-1} \cdot P = X_{n} =X$

则称状态转移后收敛于一个稳定的状态

我们可以通过P去研究一个随机的过程

## 举例说明

下面用三个例子来说明如何构建一步状态转移概率矩阵

### 一维随机游走问题

设一质点在如图所示的直线的点集I={1,2,3,4,5}上随机游动，并仅在1秒，2秒等等整秒的时刻发生游动。

![例1图](../img/%E4%B8%80%E6%AD%A5%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5_1.png)

游动的规则是：

1. 如果Q现在位于点i (1< i <5)，则下一时刻各以
$\frac{1}{3}$
的概率向左或向右移动一格，或以
$\frac{1}{3}$
的概率留在原处；
2. 如果Q现在位于1(或5)点上，则下一时刻就以概率1移动到2(对应地，或4)这一点上。

1和5这两点称为反射壁。本例这种游动称为带有两个反射壁的随机游动

解：

1. 列出状态的所有可能取值
$\Omega=\{1,2,3,4,5\}$

2. 画出矩阵P，填空

3. 求出每个
$P_{ij}$
的值，填空

## Tag

subject-note; SPnQT; Markov Chain; discrete-time Markov chain